CREATE VIEW game_switch_ps AS
SELECT 
    p.num as ps_num,
    s.num as switch_num,
    p.title,
    CASE 
        WHEN p.title IS NOT NULL AND s.title IS NOT NULL THEN 'Both'
        WHEN p.title IS NOT NULL THEN 'PS Only'
        WHEN s.title IS NOT NULL THEN 'Switch Only'
        ELSE 'None' 
    END as site_availability,
    p.price as ps_price,
    s.price as switch_price,
    p.saleprice as ps_saleprice,
    s.saleprice as switch_saleprice,
    p.saleper as ps_saleper,
    s.saleper as switch_saleper,
    p.description as ps_description,
    s.description as switch_description,
    p.imgdata as ps_imgdata,
    s.imgdata as switch_imgdata,
    p.gameimg as ps_gameimg,
    s.gameimg as switch_gameimg,
    p.url as ps_url,
    s.url as switch_url
FROM gamedata_ps p
LEFT JOIN gamedata_switch s ON p.title = s.title
UNION
SELECT 
    p.num as ps_num,
    s.num as switch_num,
    p.title,
    CASE 
        WHEN p.title IS NOT NULL AND s.title IS NOT NULL THEN 'Both'
        WHEN p.title IS NOT NULL THEN 'PS Only'
        WHEN s.title IS NOT NULL THEN 'Switch Only'
        ELSE 'None' 
    END as site_availability,
    p.price as ps_price,
    s.price as switch_price,
    p.saleprice as ps_saleprice,
    s.saleprice as switch_saleprice,
    p.saleper as ps_saleper,
    s.saleper as switch_saleper,
    p.description as ps_description,
    s.description as switch_description,
    p.imgdata as ps_imgdata,
    s.imgdata as switch_imgdata,
    p.gameimg as ps_gameimg,
    s.gameimg as switch_gameimg,
    p.url as ps_url,
    s.url as switch_url
FROM gamedata_ps p
LEFT JOIN gamedata_switch s ON p.title = s.title;